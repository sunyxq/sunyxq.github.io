# HTTPS

## 什么是https

https是在http上建立ssl加密层，并对传输数据进行加密，是http协议的安全版。简单总结为：

```js
  https = http + ssl/tls
```

`https`的主要作用：
- 对数据进行加密，并建立一个信息安全通道，来保证输出过程中的信息安全
- 对服务端进行真实身份认证

## http存在的问题
在`http`协议中可能存在信息窃取或身份伪装等安全问题
- 通信使用明文(不加密)，内容可能被窃听
- 无法证明报文的完整性，可能遭篡改
- 不验证通信方的身份，可能遭伪装



## https过程
1. 客户端发起https请求
2. 服务端把配置好的公钥证书返回给客户端
3. 客户端验证公钥证书，如果验证通过则继续，不通过则显示警告信息
4. 客户端利用伪随机数生成器生成加密使用的对称密钥--**会话密钥**，然后用证书的公钥加密这个会话密钥并发给服务端
5. 服务端使用自己的私钥解密这个消息，并得到对称密钥--**会话密钥**。这是，客户端和服务端都有相同的对称密钥。
6. 服务端通过对称密钥加密“明文内容”，发送给客户端
7. 客户端通过对称密钥解密响应的密文，得到“明文内容”
8. 客户端再次发起https请求，使用对称密钥加密请求的“明文内容”，服务端收到请求后使用对称密钥解密密文，得到客户端发送的“明文内容”

## https作用
1. 校验通信双方 -- 数字证书
服务端提交必要信息申请证书，第三方CA审核信息并颁发证书，包含数字签名

1. 加密数据 -- 通过非对称密钥和对称密钥
使用对称密钥的好处是：加解密效率快，使用非对称加密的好处是，传输数据不能被破解。

3. 校验数据完整性 -- 数字签名
数字签名的作用：
- 确定消息确实由发送方签名并发出，因为别人假冒不了发送方的签名
- 数字签名能确定数据的完整性，确保数据没被篡改过

数据签名过程：服务端一段**验证信息**经过**哈希函数**生成**消息摘要**，然后经过**私钥加密**成**数据签名**，客户端接收到报文后，通过**公钥**解密得到**消息摘要**，客户端也会把同一段**验证信息**经过**哈希函数**生成**消息摘要**，通过比较解密得到的**消息摘要**和客户端生成的消息摘要是否相同，验证消息的完整性

## http和htts区别
1. http是明文传输，https是有http+ssl构建的可加密传输、身份认证的网络协议，比http安全
2. https比http更安全，对搜索引擎更友好，利于seo
3. https需要用到ssl证书，而http不用
4. https默认端口号443，http默认端口80
5. https基于传输层，http基于应用层
   
## 参考
1. [深入理解HTTPS工作原理](https://juejin.im/post/5ca6a109e51d4544e27e3048#heading-10)